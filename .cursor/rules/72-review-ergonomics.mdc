---
description: "Review ergonomics, PR size guidance, and checklists for L9."
globs:
  - ".github/PULL_REQUEST_TEMPLATE*"
  - ".github/ISSUE_TEMPLATE*"
  - "**/*.md"
alwaysApply: false
---

# Review ergonomics (L9)

## PR size and scope

- Prefer **small, focused PRs** over large mixed changes.
- If a change grows beyond a reasonable diff size, consider splitting into separate, reviewable chunks.

---

## Review checklist

- For each PR, reviewers should confirm:
  - Scope is clearly described and limited.
  - Critical invariants (safety, memory, protected-core, infra) are respected.
  - Appropriate tests were added or updated (see `50-qa-testing.mdc`).
  - Risk and rollback plan are briefly described for high-impact changes.

---

## Templates and documentation

- Keep PR and issue templates aligned with these review rules.
- Use documentation (`*.md`) to clarify intent and risks for non-trivial changes.

---

## GMP Report naming convention

**MANDATORY:** All GMP reports must follow this naming pattern:

```
Report_GMP-##-Description.md
```

**Components:**
- `Report_` — Fixed prefix
- `GMP-##` — GMP ID number (e.g., GMP-11, GMP-22)
- `-Description` — Kebab-case description of the GMP
- `.md` — Markdown extension

**Examples:**
- ✅ `Report_GMP-11-Igor-Command-Interface.md`
- ✅ `Report_GMP-22-Governance-Python-Engine.md`
- ✅ `Report_GMP-AUDIT-Combined-Orchestrators.md`

**Anti-patterns:**
- ❌ `GMP_Report_GMP-11.md` (wrong prefix format)
- ❌ `exec_report_gmp_l2_metadata.md` (legacy format)
- ❌ `GMP-Report-Emma-Substrate.md` (wrong prefix)

**Path:** All reports stored in `/reports/`

---

## Cursor Brief Policy

**Path for Cursor-generated briefs:** `/docs/cursor-briefs/`

**When to create a brief:**
- Analysis summaries that don't warrant a full GMP report
- Status snapshots during exploration
- Temporary reference docs during debugging

**When NOT to create a brief (use GMP report instead):**
- Any change that modifies code — use `/reports/Report_GMP-##-Description.md`
- Any execution with TODO plan — use GMP report
- Post-deployment verification — use GMP report

**NEVER CREATE BOTH:** If a GMP runs, produce a report. If exploring, produce a brief. Never both.

**Anti-patterns:**
- ❌ Saving briefs to `/docs/` root (contaminates user docs)
- ❌ Creating brief AND report for same work
- ❌ Creating briefs without clear purpose

**User docs folder (`/docs/`):** Reserved for Igor's documentation. Cursor should not save files here directly.

---

## workflow_state.md Update Protocol

**Path:** `/workflow_state.md` (project root)

**MANDATORY:** Update `workflow_state.md` after:
- Every GMP or `/gmp` execution (add to Recent Changes)
- Any code change that modifies repository structure
- Major architectural decisions (add to Decision Log)
- Phase transitions (update PHASE section)
- Test runs with results (update Test Status)
- TODO completion (update Active TODO Plan)

**DO NOT update for:**
- Informational queries that change nothing
- Read-only analysis or exploration
- Simple clarification questions

### Required Sections

| Section | When to Update |
|---------|----------------|
| `## PHASE` | On phase transitions |
| `## Active TODO Plan` | When TODOs added/completed |
| `## Files in Scope` | When working on new files |
| `## Test Status` | After test runs |
| `## Recent Changes` | **EVERY change** (prepend newest at top) |
| `## Decision Log` | Major decisions only |
| `## Open Questions` | When blockers identified |
| `## Next Steps` | At session end or priority change |
| `## Recent Sessions` | At session end (7-day window) |

### Recent Changes Format

```
- [DATE] [PHASE] Files: file1.py, file2.py | Action: Brief description | Tests: pass/fail/not run
```

### Recent Sessions Format

```
- ✅ YYYY-MM-DD: Brief session summary with key outcomes
```

- Mark completed sessions with `✅`
- Keep only 7 days of history
- Add new entries at TOP (newest first)

### Anti-patterns

- ❌ Skipping update after GMP execution
- ❌ Verbose descriptions (keep entries concise)
- ❌ Updating for read-only queries
- ❌ Forgetting to mark sessions with ✅

---
