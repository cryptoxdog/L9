---
description: "Map files to L9 tiers (kernel, runtime, infra, UX) and inject the right GMP module prompts per tier."
alwaysApply: true
---

# Module ↔ tier mapping (L9)

## Tier classification

- For any change, first classify each touched file into one of:
  - `KERNEL_TIER`: kernels, executor, websocket orchestrator, memory substrate core.
  - `RUNTIME_TIER`: task queue, Redis client, rate limiter, tool registry, agents.
  - `INFRA_TIER`: docker-compose, infra, deploy, k8s, helm.
  - `UX_TIER`: React/Next UI, TS client, docs, non-critical scripts.

Use quick heuristics:

- `KERNEL_TIER` if path matches: `l9/kernel_loader.py`, `l9/executor.py`, `l9/websocket_orchestrator.py`, `l9/memory_substrate_service.py`.
- `RUNTIME_TIER` if path matches: `l9/task_queue.py`, `l9/redis_client.py`, `l9/tool_registry.py`, `l9/long_plan_graph.py`, core agent modules.
- `INFRA_TIER` if path under: `docker-compose.yml`, `infra/**`, `deploy/**`, `kubernetes/**`, `helm/**`.
- `UX_TIER` for frontend code, docs, and glue scripts.

---

## GMP module injection per tier

For each tier, inject a specific GMP module into your prompt:

- `KERNEL_TIER`: use **GMP-System** + **GMP-Action** + **GMP-Audit Canonical** (full stack).
- `RUNTIME_TIER`: use **GMP-Action** + **Integration-Tests** modules.
- `INFRA_TIER`: use **DEPLOYMENT_MANIFEST_v1.7** + **Wire-Orchestrators** + **Critical-Path Tests**.
- `UX_TIER`: use **Unit-Test-Quality** + **Generator** modules only.

In prompts:

> “Tier: RUNTIME_TIER (executor + task queue). Apply GMP-Action-v1.7 and GMP-Action-Integration-Tests-v1.0 patterns only.”

---

## Per-file checklist before edit

For each file in scope:

- Confirm tier and list:
  - Purpose of file.
  - Public APIs it exposes.
  - Direct dependencies (imports).
  - Tests that currently cover it (unit, integration, critical-path).
- Reject ambiguous scopes:
  - If a file cannot be clearly assigned to a single tier, STOP and request clarification in the prompt.

---
