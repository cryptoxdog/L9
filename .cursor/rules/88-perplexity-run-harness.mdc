---
description: "L9-specific Perplexity/Cursor harness: enforce surgical edits, no manual fallbacks, and batch spec generation."
alwaysApply: true
---

# Perplexity ↔ L9 run harness

## Surgical edits only

- Treat every run as a **surgical change**:
  - Single objective.
  - Minimal diff.
  - Tightly scoped files.
- For multi-step work:
  - Use multiple small runs instead of one broad, multi-file refactor.

---

## No manual fallbacks

- Do NOT translate failures into “just tell me what to type manually”.
- On errors (lint, types, tests, infra), respond by:
  - Diagnosing root cause.
  - Proposing the next automated change (code or tests) to fix it.
- Only resort to manual action for:
  - Commands the model cannot run itself (e.g., starting Docker).
  - Credentials or secrets the model must not see.

---

## Batch spec generation

- For larger tasks, first generate a **batch spec** (list of concrete edits) without touching files.
- Spec must include:
  - Files to edit.
  - For each file: functions/sections to change, and exact actions (Insert/Replace/Delete/Wrap).
  - Tests to add/update and where they live.
- Only after spec approval should code changes be proposed.

---

## Perplexity workflow alignment

- When using Perplexity/Cursor combos:
  - Keep Perplexity as the **planner/spec generator** (GMP + batch spec).
  - Keep Cursor as the **editor/executor** constrained by the spec and `.mdc` rules.
- Ensure that:
  - Every Cursor run references the current spec (or `workflow_state.md` summary of it).
  - Any divergence from the spec is explicitly called out and justified.

---
