# GMP-1 ‚Äî Normalize Tool + Capability Models for L

You are C (Cursor) operating inside the L9 repository.

You are not designing new product features.
You are not touching non-.py files.
You are aligning internal Python schemas so L can reason about tools and capabilities coherently.

## üéØ OBJECTIVE (LOCKED)

Unify the internal **capability model** (`capabilities.py`) and the **tool graph model** (`tool_graph.py`) so:

1. Every tool L may use has:
   - `category`, `scope`, `is_destructive`, `requires_confirmation`.
2. L‚Äôs own capability profile exists and can express:
   - ‚ÄúGMP runs and git commits require Igor‚Äôs explicit approval.‚Äù
3. The Neo4j ToolGraph can store those flags for auditing and governance.

## üß± SCOPE (FILES ONLY)

You MAY modify:

- `capabilities.py`
- `tool_graph.py`

You MAY NOT:

- Touch any non-`.py` files.
- Add new external dependencies.
- Change runtime behavior of other modules beyond what is required to expose metadata.

## REQUIRED CHANGES

1Ô∏è‚É£ Extend Tool / Capability models

- In `capabilities.py`:
  - Add new `ToolName` entries for:
    - `GMP_RUN`
    - `GIT_COMMIT`
    - `MCP_CALL_TOOL`
    - `MAC_AGENT_EXEC_TASK`
  - Add (if missing) fields or helpers needed to:
    - Express `requires_igor_approval: bool` in capability metadata (e.g., via `scope` or a new field).
- In `tool_graph.py`:
  - Extend `ToolDefinition` to optionally include:
    - `scope: str` (e.g. `"internal" | "external"`)
    - `risk_level: str` (e.g. `"low" | "medium" | "high"`)
  - Ensure `register_tool` persists these attributes into Neo4j node properties. [file:117]

2Ô∏è‚É£ Define L‚Äôs default capability profile

- Introduce an `AgentCapabilities` instance for L:
  - `agent_id="L"`
  - Allowed:
    - `MEMORY_READ`, `MEMORY_WRITE`
    - `WORLD_MODEL_QUERY`, `KERNEL_READ`
    - `MCP_CALL_TOOL`
    - `MAC_AGENT_EXEC_TASK`
  - Conditionally allowed:
    - `GMP_RUN`, `GIT_COMMIT` but marked as requiring Igor approval via:
      - `scope="requires_igor_approval"` or equivalent clearly named mechanism.
  - `NETWORK` capability remains gated as you judge appropriate.

3Ô∏è‚É£ ToolGraph registration helpers

- Add convenience helpers in `tool_graph.py` to register tools with full metadata:
  - `category` (e.g., `"memory"`, `"execution"`, `"integration"`, `"governance"`).
  - `scope` (e.g., `"internal"`, `"external"`).
  - `risk_level` and `requires_confirmation`.

4Ô∏è‚É£ NO RUNTIME SIDE EFFECTS

- Do not enqueue any tasks, call Redis, or touch runtime logic outside of model definitions and registration functions.
- Keep changes local and deterministic.

## FINAL VALIDATION

- Static type check passes (if mypy/pyright is configured).
- Imports from `capabilities.py` and `tool_graph.py` remain valid.
- New fields are optional-compatible with any existing callers (provide defaults).

END PROMPT ‚Äî EXECUTE FULLY, THEN STOP.
