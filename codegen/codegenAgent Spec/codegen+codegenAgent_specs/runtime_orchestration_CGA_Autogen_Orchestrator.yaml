# ============================================================
# PATCH â€” CGA_Autogen_Orchestrator.py
# Purpose: Route agents into orchestrator DAGs using construct_features
# ============================================================

filename: runtime/orchestration/CGA_Autogen_Orchestrator.py
patch_type: orchestrator_expansion
language: python
description: |
  Enables CGA to include feature-specific orchestration logic
  based on construct_features in the agent schema.

patch:
  update_function: generate_orchestrators
  recursive_enrichment_passes: 3
  enriched_code: |
    def generate_orchestrators():
        schemas = load_yaml_schemas('schemas/agents/')
        for agent_schema in schemas:
            features = agent_schema.get("construct_features", {})
            dag_code = emit_dag_from_spec(agent_schema)

            if features.get("patchable_via_reflection", False):
                dag_code += "\n# Reflection loop support enabled"

            if features.get("self_healing_hooks", False):
                dag_code += "\n# Auto-repair agent wiring embedded"

            outfile = f'orchestrators/generated/{agent_schema["id"]}_orchestrator.py'
            with open(outfile, 'w') as f:
                f.write(dag_code)